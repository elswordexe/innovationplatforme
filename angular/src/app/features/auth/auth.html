<div class="flex-1 min-h-screen">
    <div class="min-h-screen grid lg:grid-cols-2">
         <div class="hidden lg:flex flex-col justify-center px-12 xl:px-20 bg-gradient-to-br from-white via-[var(--brand-soft)] to-white">
    <div class="max-w-xl fade-in" style="animation-delay:0.15s">
      <h1 class="hero-title mb-6">PinBoard</h1>
      <p class="text-2xl text-[var(--text-sub)] leading-relaxed mb-10">
        Transformez vos idées en projets collaboratifs structurés.
      </p>
      <p class="text-lg text-[var(--text-muted)]">
        Pensé pour les fondateurs, créateurs et organisations.
      </p>
    </div>
  </div><div class="flex items-center justify-center px-6 py-12 lg:py-0">
    <div class="w-full max-w-md glass rounded-3xl p-10 md:p-12 fade-in" style="animation-delay:0.25s">

      <!-- Onglets -->
      <div *ngIf="showTabs" class="flex bg-black/5 dark:bg-white/8 rounded-full p-1 mb-10">
        <button (click)="switchToLogin()" [ngClass]="{ 'tab-active': showLogin }" class="flex-1 py-3 rounded-full text-sm transition-all">Se connecter</button>
        <button (click)="switchToRegister()" [ngClass]="{ 'tab-active': showRegister }" class="flex-1 py-3 rounded-full text-sm text-[var(--text-sub)] hover:text-[var(--text)] transition-all">Créer un compte</button>
      </div>

      <!-- Message d'erreur -->
      <div *ngIf="errorMessage" class="p-4 bg-red-50 border border-red-200 rounded-lg text-red-700 mb-4">
        {{ errorMessage }}
      </div>
      <div *ngIf="infoMessage" class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg text-yellow-800 mb-4">
        {{ infoMessage }}
      </div>

      <!-- CONNEXION -->
      <form *ngIf="showLogin" (ngSubmit)="onLogin($event)" class="space-y-6">
        <h2 class="text-2xl font-semibold tracking-tight">Ravi de vous revoir</h2>
        <p class="text-[var(--text-sub)]">Connectez-vous à votre compte PinBoard</p>

        <input [(ngModel)]="loginEmail" name="email" class="apple-input w-full" type="email" placeholder="Adresse email" required autocomplete="email" />
        <input [(ngModel)]="loginPassword" name="password" class="apple-input w-full" type="password" placeholder="Mot de passe" required autocomplete="current-password" />

        <button [disabled]="loading" type="submit" class="apple-button w-full">
          {{ loading ? 'Connexion...' : 'Se connecter' }}
        </button>

        <!-- Connexion via SSO (organisation) -->
        <div class="pt-3">
          <label class="text-sm text-[var(--text-sub)]">Se connecter avec un code SSO</label>
          <div class="flex gap-2 mt-2">
            <button type="button" class="apple-button" (click)="startSsoFlow()" [disabled]="loading">Connexion SSO</button>
          </div>

          <div *ngIf="showSsoPrompt" class="mt-3">
            <label class="text-sm text-[var(--text-sub)]">Entrez votre code SSO</label>
            <input [(ngModel)]="ssoLoginCode" name="ssoLoginCode" class="apple-input w-full mt-2" type="text" placeholder="Code SSO" maxlength="6" />
            <div class="flex gap-2 mt-2">
              <button type="button" class="apple-button" (click)="confirmSsoCode($event)" [disabled]="loading">Valider code SSO</button>
              <button type="button" class="apple-button" (click)="cancelSso()">Annuler</button>
            </div>
          </div>
        </div>

        <p class="text-center text-sm text-[var(--text-muted)] mt-4">
          <a href="#" class="hover:text-[var(--brand)] transition-colors">Mot de passe oublié ?</a>
        </p>
      </form>

      <!-- INSCRIPTION -->
      <form *ngIf="showRegister" (ngSubmit)="onRegister($event)" class="space-y-6">
        <h2 class="text-2xl font-semibold tracking-tight">Créer votre compte</h2>
        <p class="text-[var(--text-sub)]">Rejoignez PinBoard en quelques secondes</p>

        <input [(ngModel)]="registerName" name="fullname" class="apple-input w-full" type="text" placeholder="Nom complet" required autocomplete="name" />
        <input [(ngModel)]="registerEmail" name="email" class="apple-input w-full" type="email" placeholder="Adresse email" required autocomplete="email" />
        <input [(ngModel)]="registerPassword" name="password" class="apple-input w-full" type="password" placeholder="Mot de passe" required autocomplete="new-password" />

        <div class="space-y-2">
          <label class="text-sm text-[var(--text-sub)]">Rôle</label>
          <select [(ngModel)]="registerRole" name="registerRole" class="apple-input w-full">
            <option value="USER">Utilisateur</option>
            <option value="MANAGER">Manager</option>
            <option value="HR">RH</option>
          </select>
        </div>

        <div *ngIf="registerEntityType === 'startup' || registerEntityType === 'organization'" class="space-y-2">
          <label class="text-sm text-[var(--text-sub)]">Nom de l'entreprise / startup</label>
          <input [(ngModel)]="registerTenantName" name="registerTenantName" class="apple-input w-full" type="text" placeholder="Ex: Acme Startup" />
        </div>

        <!-- Si l'utilisateur vient de choisir Startup/Org, permettre de saisir un Code SSO ici -->
        <div *ngIf="registerEntityType === 'startup' || registerEntityType === 'organization'" class="space-y-2">
          <label class="text-sm text-[var(--text-sub)]">Code SSO (optionnel)</label>
          <div class="flex gap-2">
            <input [(ngModel)]="registerSsoCode" name="registerSsoCode" class="apple-input flex-1 tracking-widest uppercase" type="text" placeholder="Ex: ABC123" maxlength="6" />
            <button type="button" class="apple-button" (click)="generateSsoCode()">Générer</button>
          </div>
          <p class="text-xs text-[var(--text-muted)]">Si vous possédez déjà un code SSO, saisissez-le. Sinon, cliquez sur "Générer" pour en créer un et partager avec vos membres.</p>
          <div *ngIf="ssoCreated" class="p-3 bg-green-50 border border-green-100 rounded text-green-700 mt-2">Code SSO généré : <strong class="ml-2">{{ registerSsoCode }}</strong></div>
        </div>

        <button [disabled]="loading" type="submit" class="apple-button w-full">
          {{ loading ? 'Inscription...' : 'Créer mon compte' }}
        </button>

        <p class="text-center text-sm text-[var(--text-muted)]">
          Déjà inscrit ? <button type="button" (click)="switchToLogin()" class="text-[var(--brand)] hover:underline">Se connecter</button>
        </p>
      </form>

      <!-- ONBOARDING 1 -->
      <div *ngIf="showOnboarding1" class="space-y-5">
        <h2 class="text-2xl font-semibold tracking-tight">Bienvenue sur PinBoard</h2>
        <p class="text-[var(--text-sub)]">Comment comptez-vous utiliser la plateforme ?</p>

        <button (click)="selectUserType('individual')" type="button" class="apple-input w-full text-left font-medium hover:bg-opacity-80">Je suis un créateur / innovateur individuel</button>
        <button (click)="selectUserType('startup')" type="button" class="apple-input w-full text-left font-medium hover:bg-opacity-80">Je représente une startup ou petite équipe</button>
        <button (click)="selectUserType('organization')" type="button" class="apple-input w-full text-left font-medium hover:bg-opacity-80">Je représente une organisation / entreprise</button>

        <!-- Si l'utilisateur choisit 'startup' ou 'organization', permettre de créer ou saisir un code SSO -->
        <div *ngIf="registerEntityType === 'startup' || registerEntityType === 'organization'" class="space-y-2">
          <label class="text-sm text-[var(--text-sub)]">Code SSO (6 caractères)</label>
          <div class="flex gap-2">
            <input name="ssoCode" [(ngModel)]="registerSsoCode" class="apple-input flex-1 tracking-widest uppercase" type="text" placeholder="Ex: ABC123" maxlength="6" pattern="[A-Za-z0-9]{6}" title="6 caractères alphanumériques" />
            <button type="button" class="apple-button" (click)="generateSsoCode()">Générer</button>
          </div>
          <p class="text-xs text-[var(--text-muted)]">Saisissez le code fourni par votre startup/organisation, ou générez-en un nouveau et partagez-le avec vos membres.</p>

          <!-- Le tenant sera créé automatiquement si vous n'en avez pas :
               cliquer sur "Créer tenant & SSO" crée le tenant puis le code SSO côté serveur.
               Vous pouvez aussi utiliser le code localement sans appeler le serveur. -->
          <div *ngIf="ssoCreated" class="p-3 bg-green-50 border border-green-100 rounded text-green-700 mt-2">Code SSO : <strong class="ml-2">{{ registerSsoCode }}</strong></div>
        </div>
      </div>

      <!-- ONBOARDING 2 -->
      <div id="onboarding2" class="space-y-5 hidden">
        <h2 class="text-2xl font-semibold tracking-tight">Et maintenant ?</h2>
        <p class="text-[var(--text-sub)]">Quelle est votre première action ?</p>

        <button class="apple-input w-full font-medium">Parcourir et rejoindre des projets existants</button>
        <button class="apple-input w-full font-medium">Déposer ma première idée / projet</button>

        <button class="apple-button w-full mt-6">Terminer</button>
      </div>

    </div>
  </div>

</div></div>
